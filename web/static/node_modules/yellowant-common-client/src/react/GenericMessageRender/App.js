import React from "react";
import ReactDOM from "react-dom";
import "./App.scss";

class GenericMessageRender extends React.Component {
  constructor() {
    super();
    this.globalVars = globalVars;

    this.state = {
      funFact: null
    }
    
    switch(this.globalVars.message_type) {
      case 0:
        this.message_title = "Oops!";
        break;
      case 1:
        this.message_title = "Hurray!";
        break;
      default:
        this.message_title = null;
        break;
    }

    this.getFunFact();

    this.redirectCheck();
  }

  getFunFact() {
    if (window.fetch) {
       fetch("http://numbersapi.com/random")
        .then((resp) => resp.text())
        .then((data) => {
          this.setState({
            funFact: data
          })
        });
    }
  }

  redirectCheck() {
    if (this.globalVars.return_url) {
      setTimeout(function () {
        window.location.href = this.globalVars.return_url;
      }, 6000);
    }
  }

  render() {
    return (
      <div>
        <section className="mt3 mb5">
          <div className="mw5 center">
            <a href="https://www.yellowant.com">
              <img src={require("../../assets/images/yellowant-text-logo.png")} />
            </a>
          </div>
        </section>

        <section className="mw7 center flex flex-column items-center">
          {
            this.globalVars.message_code ?
            <h1 className="f1 tc">{ this.globalVars.message_code }</h1> :
            null
          }
          { this.message_title ?
            <h2 className="f2 tc">{ this.message_title }</h2> :
            null
          }
          {
            this.globalVars.message_text ?
            <div className="f4 mb4">{ this.globalVars.message_text }</div> : 
            null
          }
          {
            this.globalVars.return_url ?
            <div>
              <div className="mt4 tc mb3">
                <a href={ this.globalVars.return_url } className="f3 dim pv2 ph4 ba br3">{ this.globalVars.return_url_text || 'Return' }</a>              
              </div>
              <div className="mb4">Redirecting you shortly.</div>
            </div> :
            null
          }
          {
            this.state.funFact ?
            <div className="tc">Fact:<br />{ this.state.funFact }</div> :
            null
          }
        </section>
      </div>
    )
  }
}

ReactDOM.render(
  React.createElement(GenericMessageRender),
  document.getElementById("GenericMessageRender")
);